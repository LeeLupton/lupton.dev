<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta charset="UTF-8">
  <meta name="author" content="Lee Lupton">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;700&display=swap" rel="stylesheet"> 
  <link rel="stylesheet" href="css/styles.css">
  <link rel="icon" type="image/x-icon" href="assets/favicon.ico">
  <title>Secure Financial Portal</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/4.1.1/crypto-js.min.js"></script>
    <style>
    body {
      background: #222; 
      color: #eee; 
      font-family: Arial, sans-serif; 
      margin: 0; 
      padding: 0;
    }
    /* Login Section Styling */
    #loginSection {
      text-align: center;
      padding: 30px;
    }
    #loginSection form {
      display: inline-block;
      margin-top: 20px;
    }
    #loginSection input[type="password"] {
      padding: 10px;
      font-size: 16px;
      width: 220px;
    }
    #loginSection button {
      padding: 10px 20px;
      font-size: 16px;
      margin-top: 10px;
    }
    #loginSection label {
      font-size: 14px;
      margin-left: 5px;
    }
    #errorMsg {
      color: red;
      margin-top: 10px;
    }
    /* Main Content that will be decrypted */
    #mainContent {
      display: none; /* Initially hidden */
      padding: 20px;
    }
  </style>
</head>
<body>

    <div id="loginSection">
    <h2>Please Log In to Access Your Portal</h2>
        <form id="loginForm" onsubmit="event.preventDefault(); decryptAndLoad();">
            <input type="password" id="loginPassword" name="loginPassword" placeholder="Enter your password" autocomplete="current-password">
      <br>
            <input type="checkbox" id="rememberCheckbox" name="rememberCheckbox">
      <label for="rememberCheckbox">Remember my password</label>
      <br>
      <button type="submit">Login</button>
    </form>
    <p id="errorMsg"></p>
  </div>

    <div id="mainContent">
     </div>

    <script>
    // !!! REPLACE THE VALUE BELOW WITH THE ACTUAL CIPHERTEXT GENERATED IN STEP 2 !!!
    var ciphertext = "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"; // <-- PASTE HERE

    // Function to decrypt the encrypted dashboard content.
    function decryptAndLoad() {
      var pwd = document.getElementById('loginPassword').value;
      if (!pwd) {
        document.getElementById("errorMsg").textContent = "Please enter a password.";
        return;
      }
      try {
        // Decrypt the ciphertext using the user-supplied password.
        var bytes = CryptoJS.AES.decrypt(ciphertext, pwd);
        var decryptedText = bytes.toString(CryptoJS.enc.Utf8);

        if (decryptedText) {
          // Inject the decrypted content into the mainContent div.
          // We need to handle potential script execution within the decrypted content.
          // A common way is to append it and let the browser handle parsing.
          var mainContentDiv = document.getElementById("mainContent");
          mainContentDiv.innerHTML = decryptedText; // Inject HTML

          // Find and execute scripts within the injected content
          var scripts = mainContentDiv.getElementsByTagName('script');
          for (var i = 0; i < scripts.length; i++) {
              var script = scripts[i];
              var newScript = document.createElement('script');
              // Copy attributes (like src)
              if (script.src) {
                  newScript.src = script.src;
                  // Ensure async/defer attributes are handled if needed, though often sync execution is expected here.
                  newScript.onload = function() {
                      // Check if the initializeDashboard function exists AFTER the script has loaded/executed
                      if (typeof initializeDashboard === "function") {
                          console.log("Calling initializeDashboard after script load.");
                          initializeDashboard();
                      }
                  };
                   newScript.onerror = function() { console.error("Error loading script: " + newScript.src);};
              } else {
                  newScript.textContent = script.textContent; // Copy inline script content
              }
              // Append the new script element to execute it.
              // Appending to head or body is common. Appending back into mainContent might work but can be less reliable.
              document.body.appendChild(newScript);
              // Remove the original placeholder script tag from the injected content
              // Or handle differently depending on desired script execution order.
              // For simplicity here, we assume initializeDashboard is defined by inline script or loaded synchronously.
              // script.parentNode.removeChild(script); // Careful with modifying collection while iterating
          }


          // Hide the login section, show the main content.
          document.getElementById("loginSection").style.display = "none";
          mainContentDiv.style.display = "block";

          // Attempt to call initializeDashboard immediately for inline scripts
          // Check if the function was defined by an *inline* script within decryptedText
          if (typeof initializeDashboard === "function") {
              console.log("Calling initializeDashboard immediately after injection (for inline scripts).");
              initializeDashboard();
          } else {
              console.log("initializeDashboard not found immediately after injection. Waiting for external scripts if any.");
          }

        } else {
          // This happens if the password is wrong OR if the decrypted text is empty
          document.getElementById("errorMsg").textContent = "Incorrect password or decryption failed.";
        }
      } catch (e) {
        // This catches errors during the decryption process itself (e.g., malformed ciphertext)
        console.error("Decryption error:", e);
        document.getElementById("errorMsg").textContent = "Decryption error. Check password or ciphertext integrity.";
      }
    }
  </script>
</body>
</html>
